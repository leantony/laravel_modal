var leantony={};!function(a){leantony.utils={loadLink:function(a,b){a||(a=location.href),b?setTimeout(function(){window.location=a},b):window.location=a},processMessageObject:function(b){var c="";return"object"===a.type(b)?a.each(b,function(a,b){c+="<li>"+b[0]+"</li>"}):c+="<p>"+b+"</p>",c},renderAlert:function(b,c){var d=["success","error","notice"],e="";return(void 0===typeof b||a.inArray(b,d)<0)&&(b=d[0]),e+="success"===b?'<div class="alert alert-success">':"error"===b?'<div class="alert alert-danger">':'<div class="alert alert-warning">',e+='<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>',"error"===b&&(e+="<strong>Please fix the following errors:</strong>"),c=this.processMessageObject(c),e+c+"</div>"}}}(jQuery),leantony.modal=leantony.modal||{},function(a){"use strict";var b=function(b){var c={modal_id:"bootstrap_modal",notification_id:"modal-notification",form_id:"modal_form",modalTriggerSelector:".show_modal_form",onShown:function(a,b){},onHidden:function(b,c){a(this).removeData("bs.modal")},onShow:function(b,c){var d='<div class="row"><div class="col-md-12"><i class="fa fa-spinner fa-5x fa-spin text-info"></i></div></div>';a("#"+c.options.modal_id).find(".modal-content").html(d)},onLoaded:function(a,b){}};this.options=a.extend({},c,b||{})};b.prototype.show=function(){var b=this,c=b.options.modal_id,d=function(d){var e=a(d).data("modal-size");_.isEmpty(e)||a("#"+c).find(".modal-dialog").addClass(e);var f=a(d).attr("href"),g=a("#"+c);g.on("shown.bs.modal",function(){b.options.onShown.call(this,d,b)}).on("hidden.bs.modal",function(){b.options.onHidden.call(this,d,b)}).on("show.bs.modal",function(){b.options.onShow.call(this,d,b)}).on("loaded.bs.modal",function(){b.options.onLoaded.call(this,d,b)}).modal({remote:f,backdrop:"static",refresh:!0})};a(document.body).off("click.leantony.modal").on("click.leantony.modal",b.options.modalTriggerSelector,function(a){a.preventDefault(),d(this)})},b.prototype.submitForm=function(){var b=this,c=function(c){var d=a("#"+b.options.form_id),e=d.serialize(),f=d.attr("action"),g=d.attr("method")||"POST",h=a(c).html();a.ajax({type:g,url:f,data:e,dataType:"json",success:function(c){if(c.success){var d='<i class="fa fa-check"></i> ';d+=c.message,a("#"+b.options.notification_id).html(leantony.utils.renderAlert("success",d)),c.redirectTo?leantony.utils.loadLink(c.redirectTo,c.redirectTimeout||1e3):setTimeout(function(){a("#"+b.options.modal_id).modal("hide")},1e3)}else a("#"+b.options.notification_id).html(leantony.utils.renderAlert("error",c.message)),setTimeout(function(){a("#"+b.options.modal_id).modal("hide")},1e3)},beforeSend:function(){a(c).attr("disabled","disabled").html("Please wait....")},complete:function(){a(c).html(h).removeAttr("disabled")},error:function(c){var d;switch(c.status){case 500:d="A server error occurred...";break;default:d=leantony.utils.renderAlert("error",c.responseJSON)}a("#"+b.options.notification_id).html(d)}})};a("#"+b.options.modal_id).off("click.leantony.modal").on("click.leantony.modal","#"+b.options.form_id+' button[type="submit"]',function(a){a.preventDefault(),c(this)})},leantony.modal=function(a){var c=new b(a);c.show(),c.submitForm()}}(jQuery);